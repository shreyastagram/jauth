# ============================================================
# Render.com Blueprint Configuration
# ============================================================
# This file configures automatic deployment on Render
# Documentation: https://render.com/docs/blueprint-spec
# ============================================================

services:
  # Web Service - Auth API
  - type: web
    name: fixhomi-auth-service
    env: docker
    region: oregon  # Change to your preferred region: oregon, frankfurt, singapore
    plan: free  # Options: free, starter, standard, pro
    
    # Build configuration
    dockerfilePath: ./Dockerfile
    
    # Environment variables
    envVars:
      - key: SPRING_PROFILES_ACTIVE
        value: prod
      
      - key: PORT
        value: 8080
      
      - key: JWT_SECRET
        generateValue: true  # Render will auto-generate a secure secret
      
      - key: JWT_EXPIRATION_MS
        value: 86400000  # 24 hours
      
      - key: JWT_REFRESH_EXPIRATION_MS
        value: 604800000  # 7 days
      
      # Database (PostgreSQL) - Will be auto-populated when you add a database
      - key: DATABASE_HOST
        fromDatabase:
          name: fixhomi-auth-db
          property: host
      
      - key: DATABASE_PORT
        fromDatabase:
          name: fixhomi-auth-db
          property: port
      
      - key: DATABASE_NAME
        fromDatabase:
          name: fixhomi-auth-db
          property: database
      
      - key: DATABASE_USERNAME
        fromDatabase:
          name: fixhomi-auth-db
          property: user
      
      - key: DATABASE_PASSWORD
        fromDatabase:
          name: fixhomi-auth-db
          property: password
      
      # Notification Provider Settings
      - key: EMAIL_PROVIDER
        value: stub  # Change to 'brevo' when ready for production email
      
      - key: SMS_PROVIDER
        value: stub  # Change to 'twilio' when ready for production SMS
      
      # Brevo Email Service (optional - only needed if EMAIL_PROVIDER=brevo)
      - key: BREVO_API_KEY
        sync: false  # Set manually when using Brevo
      
      - key: BREVO_SENDER_EMAIL
        value: noreply@fixhomi.com
      
      - key: BREVO_SENDER_NAME
        value: FixHomi
      
      # Twilio SMS configuration (only needed if SMS_PROVIDER=twilio)
      - key: TWILIO_ACCOUNT_SID
        sync: false  # Set manually in Render dashboard
      
      - key: TWILIO_AUTH_TOKEN
        sync: false  # Set manually in Render dashboard
      
      - key: TWILIO_PHONE_NUMBER
        sync: false  # Set manually in Render dashboard
      
      # OAuth2 (Google Web) - Set manually in Render dashboard
      - key: GOOGLE_CLIENT_ID
        sync: false
      
      - key: GOOGLE_CLIENT_SECRET
        sync: false
      
      # OAuth2 (Google Mobile) - For React Native mobile apps
      - key: GOOGLE_IOS_CLIENT_ID
        sync: false  # Get from Google Cloud Console
      
      - key: GOOGLE_ANDROID_CLIENT_ID
        sync: false  # Get from Google Cloud Console
      
      # Base URLs for frontend callbacks
      - key: FIXHOMI_BASE_URL
        value: https://fixhomi-auth-service.onrender.com
      
      - key: FIXHOMI_FRONTEND_URL
        value: https://app.fixhomi.com  # Update with your frontend URL
      
      # Rate Limiting
      - key: RATE_LIMIT_ENABLED
        value: true
    
    # Health check endpoint
    healthCheckPath: /actuator/health

# Database - PostgreSQL
databases:
  - name: fixhomi-auth-db
    databaseName: fixhomi_auth
    plan: free  # Options: free, starter, standard, pro
    region: oregon  # Must match service region
